# -*- coding: utf-8 -*-
"""250415_Harsh_Scarpe

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Ce4GIV_ZZ0Do2EYHrb_n8IVEHXyGh2Pc
"""

from bs4 import BeautifulSoup
import pandas as pd
import os

HTML_PATH = "/content/dataset.html"

columns = ["age", "screen_time", "sleep_hours", "stress_level", "addiction_level"]

all_data = []

with open(HTML_PATH, "r", encoding="utf-8") as f:
    soup = BeautifulSoup(f, "html.parser")

table = soup.find("table")

if table is not None:

    rows = table.find_all("tr")

    for row in rows[1:]:
        cols = row.find_all("td")

        if len(cols) < 5:
            continue

        extracted = [
            cols[0].text.strip(),
            cols[1].text.strip(),
            cols[2].text.strip(),
            cols[3].text.strip(),
            cols[4].text.strip()
        ]

        all_data.append(extracted)

df = pd.DataFrame(all_data, columns=columns)

for col in df.columns:
    df[col] = pd.to_numeric(df[col], errors="coerce")

df = df.dropna()

OUTPUT_PATH = "/content/raw_data.csv"

df.to_csv(OUTPUT_PATH, index=False)